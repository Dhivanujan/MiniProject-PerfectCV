# CV Processing Pipeline - Visual Flow

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                        CV UPLOAD (POST /upload)                      โ
โ                    User uploads PDF/DOCX file                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  STEP 1: EXTRACT CV โ JSON                                          โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  ๐ ExtractionService.process_cv()                                   โ
โ     โโ TextExtractor: Extract text from PDF/DOCX                    โ
โ     โ  โข PyMuPDF (fitz) for PDF                                     โ
โ     โ  โข docx2txt for DOCX                                           โ
โ     โ                                                                 โ
โ     โโ TextCleaner: Clean and normalize                             โ
โ     โ  โข Fix broken lines                                            โ
โ     โ  โข Normalize phone numbers                                     โ
โ     โ  โข Remove excessive whitespace                                 โ
โ     โ                                                                 โ
โ     โโ TextCleaner: Extract sections                                โ
โ     โ  โข Identify section headers (## Summary, EXPERIENCE:, etc.)   โ
โ     โ  โข Parse content for each section                             โ
โ     โ  โข Returns: summary, experience, education, skills...         โ
โ     โ                                                                 โ
โ     โโ EntityExtractor: Extract entities                            โ
โ        โข spaCy NLP (PERSON, ORG, GPE, DATE)                         โ
โ        โข Regex for email, phone                                      โ
โ        โข Returns: name, email, phone, location, skills, etc.        โ
โ                                                                       โ
โ  OUTPUT:                                                             โ
โ  {                                                                   โ
โ    "entities": {name, email, phone, location, skills, ...},         โ
โ    "sections": {summary, experience, education, skills, ...},       โ
โ    "metadata": {source_filename, extraction_method, ...}            โ
โ  }                                                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  STEP 2: VALIDATE JSON                                              โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  ๐ ValidationService.validate_cv_data()                            โ
โ     โโ Check critical fields: name, email, phone                    โ
โ     โโ Check important fields: skills, experience                   โ
โ     โโ Calculate completeness: 0-100%                               โ
โ     โโ Identify missing fields                                      โ
โ                                                                       โ
โ  OUTPUT:                                                             โ
โ  {                                                                   โ
โ    "status": "complete" | "incomplete",                             โ
โ    "missing_critical": ["phone"],                                   โ
โ    "missing_important": [],                                         โ
โ    "completeness_score": 80                                         โ
โ  }                                                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  STEP 3: IMPROVE CV (AI or Rules)                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  โจ AIService (Groq/OpenAI/Gemini)                                  โ
โ                                                                       โ
โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                                 โ
โ     โ IF missing critical fields  โ                                 โ
โ     โโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโ                                 โ
โ                โ                                                      โ
โ                โผ                                                      โ
โ     AI FALLBACK: Extract missing fields                             โ
โ     โข extract_missing_fields(text, missing_fields)                  โ
โ     โข Temperature: 0.1 (strict, no hallucination)                   โ
โ     โข CRITICAL: Only extract from text, never invent               โ
โ                                                                       โ
โ     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                                 โ
โ     โ IF content exists           โ                                 โ
โ     โโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโ                                 โ
โ                โ                                                      โ
โ                โผ                                                      โ
โ     AI ENHANCEMENT: Improve content                                 โ
โ     โข improve_cv_content(sections, job_domain)                      โ
โ     โข Enhance summary for impact                                    โ
โ     โข Optimize experience with action verbs                         โ
โ     โข Validate: improved_length >= 50% of original                  โ
โ                                                                       โ
โ  OUTPUT: Updated cv_json with improved entities & sections          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  STEP 4: RENDER HTML (Jinja2)                                       โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  ๐จ CVGenerationService                                             โ
โ     โโ _prepare_template_data(cv_json)                             โ
โ     โ  โข Parse experience into structured list                      โ
โ     โ  โข Parse education into structured list                       โ
โ     โ  โข Parse skills into array                                    โ
โ     โ  โข Format dates, locations, etc.                              โ
โ     โ                                                                 โ
โ     โโ _render_template('professional.html', template_data)         โ
โ        โข Jinja2 template engine                                     โ
โ        โข app/templates/cv/professional.html                         โ
โ        โข Professional styling with CSS                              โ
โ                                                                       โ
โ  OUTPUT: HTML string (6000+ characters)                             โ
โ  <!DOCTYPE html>                                                     โ
โ  <html>                                                              โ
โ    <head>...CSS styles...</head>                                     โ
โ    <body>                                                            โ
โ      <header>Name, contact info</header>                            โ
โ      <section class="summary">...</section>                         โ
โ      <section class="experience">...</section>                      โ
โ      ...                                                             โ
โ    </body>                                                           โ
โ  </html>                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  STEP 5: CONVERT TO PDF (WeasyPrint)                                โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  ๐ CVGenerationService._html_to_pdf_weasyprint()                   โ
โ     โโ WeasyPrint: HTML(string=html_content)                        โ
โ     โโ Render CSS styling                                           โ
โ     โโ Generate production-quality PDF                              โ
โ     โโ Return PDF bytes                                             โ
โ                                                                       โ
โ  FALLBACK:                                                           โ
โ  If WeasyPrint unavailable โ FPDF library                           โ
โ                                                                       โ
โ  OUTPUT: PDF bytes (40KB-60KB typical)                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  STEP 6: SAVE TO DATABASE                                           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  ๐พ MongoDB GridFS                                                  โ
โ     โโ Filename: ATS_{user_id}_{original_name}.pdf                 โ
โ     โโ Content type: application/pdf                                โ
โ     โโ Metadata: user_id, job_domain, ats_score                    โ
โ     โโ Store PDF bytes                                              โ
โ                                                                       โ
โ  OUTPUT: file_id (ObjectId)                                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                โ
                                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ PIPELINE COMPLETED                                              โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ  โ
โ                                                                       โ
โ  RETURN JSON RESPONSE:                                              โ
โ  {                                                                   โ
โ    "success": true,                                                 โ
โ    "file_id": "...",                                                โ
โ    "cv_json": { /* complete structured data */ },                  โ
โ    "optimized_text": "...",                                         โ
โ    "sections": {...},                                               โ
โ    "entities": {...},                                               โ
โ    "validation": {...},                                             โ
โ    "ats_score": 85,                                                 โ
โ    "suggestions": [...]                                             โ
โ  }                                                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ


โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

KEY TECHNOLOGIES:

๐ Text Extraction
   โข PyMuPDF (fitz) - PDF extraction
   โข docx2txt - DOCX extraction

๐งน Text Processing
   โข Custom TextCleaner - Normalize and clean
   โข Regex - Pattern matching

๐ค NLP & AI
   โข spaCy (en_core_web_sm) - Entity extraction
   โข Groq (Llama 3.3) - AI enhancement
   โข OpenAI GPT-4 - Alternative AI
   โข Google Gemini - Alternative AI

๐จ HTML & PDF
   โข Jinja2 - Template rendering
   โข WeasyPrint - HTML to PDF (production quality)
   โข FPDF - Fallback PDF generator

๐พ Storage
   โข MongoDB - Database
   โข GridFS - Large file storage

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

DATA FLOW:

Raw File โ Text โ Cleaned Text โ Sections + Entities โ Validated JSON
    โ AI Enhanced JSON โ HTML โ PDF โ Database โ Response

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
